# Описание задач проекта и технического задания
[Полная версия решения](https://github.com/shepelyuk-alexa/portfolio/blob/main/AB_test_evaluation/Shepelyuk_Alexandra_AB_test_project.ipynb)

**Цель исследования:** оценить корректность проведения теста recommender_system_test и проанализировать его результаты.

Чтобы оценить корректность проведения теста: удостоверимся, что нет пересечений с конкурирующим тестом и нет пользователей, участвующих в двух группах теста одновременно; проверим равномерность распределения пользователей по тестовым группам и правильность их формирования.

## Техническое задание:

* Название теста: recommender_system_test ;
* группы: А — контрольная, B — новая платёжная воронка;
* дата запуска: 2020-12-07;
* дата остановки набора новых пользователей: 2020-12-21;
* дата остановки: 2021-01-04;
* аудитория: в тест должно быть отобрано 15% новых пользователей из региона EU;
* назначение теста: тестирование изменений, связанных с внедрением улучшенной рекомендательной системы;
* ожидаемое количество участников теста: 6000
* ожидаемый эффект: за 14 дней с момента регистрации пользователи покажут улучшение каждой метрики не менее, чем на 10%:
       * конверсии в просмотр карточек товаров — событие product_page ,
       * просмотры корзины — product_cart ,
       * покупки — purchase .

## Описание данных

**ab_project_marketing_events.csv** — календарь маркетинговых событий на 2020 год.

Структура файла:
* name — название маркетингового события;
* regions — регионы, в которых будет проводиться рекламная кампания;
* start_dt — дата начала кампании;
* finish_dt — дата завершения кампании.

**final_ab_new_users.csv** — пользователи, зарегистрировавшиеся с 7 до 21 декабря 2020 года.

Структура файла:
* user_id — идентификатор пользователя;
* first_date — дата регистрации;
* region — регион пользователя;
* device — устройство, с которого происходила регистрация.

**final_ab_events.csv** — действия новых пользователей в период с 7 декабря 2020 по 4 января 2021 года.

Структура файла:
* user_id — идентификатор пользователя;
* event_dt — дата и время события;
* event_name — тип события;
* details — дополнительные данные о событии.

**final_ab_participants.csv** — таблица участников тестов.

Структура файла:
* user_id — идентификатор пользователя;
* ab_test — название теста;
* group — группа пользователя.

## Выводы и рекомендации

### При анализе результатов тестирования были выявлены факторы, которые свидетельствуют о некорректности проведенного теста:

- **Неравномерное распределение групп, некорректное формирование групп**

В тест попали пользователи не только из целевого региона (Европы).

Были зафиксированы пересекающиеся пользователи из конкурирующего теста. Исходя из статистического теста, не удалось подтвердить статистическую разницу в долях пересекающихся пользователей между двумя группами теста. Поэтому такие пользователи вероятно одинаково повлияли на результаты теста — было принято решение не избавляться от них. 

Итоговые группы распределены неравномерно, группа А почти в три раза больше группы В, разница в пропорциях статистически также подтверждена. Не было пользователей, которые попали одновременно в две группы нашего теста, соответственно группы были сформированы корректно с этой точки зрения. Однако несбалансированные выборки — это признак нарушения качества проведения теста. 

Также ИАД показал, что количество событий на пользователя распределено в двух выборках неравномерно: в контрольной группе чаще, чем в тестовой, на одного пользователя приходится большее кол-во событий (более 6) и наоборот, в тестовой группе чаще, чем в контрольной встречается меньшее кол-во событий на пользователя (до 6).

- **Наличие пользователей с нулевым количеством действий с сильным перекосом в группу В (что может говорить о сбое в сборе данных или других технических сбоях)**

Мы потеряли почти 68% пользователей из группы В, которые не совершали ни одного действия. Необходимо проверить, скорее всего, здесь была какая-то техническая ошибка в записи данных или сбой в приложении для пользователей, которым внедрили новую рекомендательную систему. За счет этого мы потеряли большое количество пользователей из тестовой группы и распределение между двумя группами стало еще более неравномерным. 

- **Пересечение с маркетинговыми активностями и возможное влияние других внешних факторов, о которых мы сделали предположение в ИАД**

Мы зафиксировали одно событие, которое могло повлиять на тест: Christmas&New Year Promo (Началось во время периода проведения теста, закончилось во время). ИАД показал, что маркетинговая активность, с которой было пересечение, судя по графику, значительно не повлияла на ход теста. Тем не менее, в будущем необходимо избегать подобных перечений при проведении тестов.

При изучении распределения числа событий по дням для группы А мы зафиксировали внезапный и довольно сильный всплеск в районе 14 декабря. Возникает предположение о каком-либо внешнем влиянии, которое могло спровоцировать такой всплеск (возможно, пиар-компания или акции/розыгрыши, которые не фиксировались в календаре маркетинговых событий). Пик этого подъема в группе А приходится на 20 декабря, затем мы наблюдаем снижение числа совершаемых событий. Здесь необходимо проверить влияние неучтенных внешних факторов. Если таких нет, возможно подобное поведение связано с сезонностью (за две недели до Нового года пользователи стали более активны). Однако этот фактор также негативно сказывается на достоверности проводимого теста. Не стоит проводить тестирование в периоды, где возможно аномальное поведение пользователей (ажиотаж в предпраздничный период и пр.) и влияние большого количества скрытых факторов.

- **Непрямая воронка данных (покупку можно совершать как напрямую, так и через корзину)**

В техническом задании не зафиксировано, на каком этапе пользователь может столкнуться с новой рекомендательной системой. Если, например, только на этапе корзины (предлагаются похожие товары и т.д.), то наш тест нельзя назвать показательным, поскольку этот этап можно пропускать и мы не можем отследить, что повлияло на покупку.

Получается, что в обеих группах бОльшая доля пользователей совершила покупку напрямую, без перехода в корзину (в группе А 572 из 833, в группе В 174 из 249)

Таким образом, очень важно прояснить, на каком этапе пользователи могут столкнуться с рекомендательной системой. Если только на этапе корзины, необходимо будет убрать события пользователей, которые совершали покупки напрямую. Это может скорректировать результаты теста + также в этом случае нам может не хватить размера выборки.

- **Временной промежуток предоставленных данных не соответствует ТЗ: в нашем датасете события до 29 декабря включительно, то есть по каким-то причинам нет данных по действиям пользователей за 5 дней**

В данных события представлены за период с 7 декабря до 29 декабря 2020 года. То есть, по сути требование ТЗ не выполняется. Более того, в случае, если часть данных утеряна, необходимо также скорректировать дату остановки набора пользователей: сейчас это 21 декабря, а грамотнее было бы сдвинуть до 16 декабря (чтобы для каждого пользователя было 14 дней лайфтайма). Или добавить недостающие данные, если это возможно.

### Результаты теста:

- По результатам тестирования удалось зафиксировать статистически значимую разницу только **между конверсиями в двух группах по событию просмотра карточек товаров**. Причем исходя из данных, конверсия в тестируемой группе ниже.

- По конверсии в другие события (просмотр корзины и покупка) не удалось зафиксировать статистически значимых различий между группами.

Ожидаемый эффект (за 14 дней с момента регистрации пользователи покажут улучшение каждой метрики не менее, чем на 10%) не достигнут.

Соответственно, если бы не было зафиксировано нарушений в проведении теста и не было бы предположений на основе данных о технических сбоях, мы могли бы сказать, что новая рекомендательная система не только не улучшила целевые показатели на 10% пунктов, но и по одному событию были зафиксированы ухудшения. То есть, внедрение этой системы не улучшает никаких показателей.

### Рекомендации:

- Поскольку тест уже проведен и бюджет на него потрачен, в первую очередь **рекомендуем попытаться выяснить причины сбоев в данных** (почему нет событий с 30 декабря по 4 января, почему такой большой процент пользователей тестовой группы не совершил ни одного действия). Если удастся восстановить часть данных, в случае если они не утрачены, можно будет пересмотреть результаты теста. Если нет, необходимо убрать пользователей, зарегистрированных после 16 декабря

- **Выяснить природу всплеска в количестве действий и регистраций 14 декабря**. Могли ли здесь повлиять скрытые факторы? Возможно, пиар-компания или акции/розыгрыши, которые не фиксировались в календаре маркетинговых событий и пр.

- Выяснить **причину попадания в тест пользователей из других регионов** — возможно нарушены правила набора, был технический сбой

- **Не пересекать аудитории конкурирующих тестов**, это затрудняет анализ результатов

- Стремиться к **равномерному распределению выборок двух тестируемых групп**, отслеживать сбалансированность групп при наборе пользователей на тест

- **Не стоит проводить тестирование в периоды, где возможно аномальное поведение пользователей** (ажиотаж в предпраздничный период и пр.) и влияние большого количества скрытых факторов. Также следует разводить маркетинговые активности и тестирование новых функций, чтобы избежать внешнего влияния.
